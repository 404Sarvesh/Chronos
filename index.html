<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chronos Elite</title>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XHH0Z0H74J"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XHH0Z0H74J');
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=JetBrains+Mono:wght@800&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-primary: #ffffff;
            --space-bg: #020205;
            --glass: rgba(128, 128, 128, 0.15);
            --glow-strength: 20px;
            --glow-particle: 8px;
        }

        body {
            background-color: var(--space-bg);
            color: var(--neon-primary);
            font-family: 'Orbitron', sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.4s ease, color 0.4s ease;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
        }

        #canvas-container {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 0;
            pointer-events: none;
        }

        #space-canvas { width: 100%; height: 100%; display: block; }

        .timer-display {
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(3rem, 18vw, 15rem);
            font-weight: 800;
            z-index: 10;
            pointer-events: none;
            text-shadow: 0 0 var(--glow-strength) var(--neon-primary);
            color: var(--neon-primary);
            width: 100%;
            line-height: 1;
            transition: text-shadow 0.2s ease, color 0.4s ease;
        }

        .stealth-active .timer-display {
            text-shadow: 0 0 calc(var(--glow-strength) / 2) var(--neon-primary);
        }

        .unit-group { width: 2.1ch; text-align: center; display: inline-block; }

        .colon-box {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 10ch;
            width: 1ch;
            gap: 1.2rem;
            opacity: 0.4;
            margin: 0 0.2rem;
        }
        
        .colon-dot {
            width: 0.8vw; height: 0.8vw;
            min-width: 8px; min-height: 8px;
            background-color: var(--neon-primary);
            border-radius: 50%;
            box-shadow: 0 0 var(--glow-particle) var(--neon-primary);
            transition: background-color 0.4s ease, box-shadow 0.2s ease;
        }

        #controls {
            position: fixed;
            bottom: 3vh;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            width: 90%;
            max-width: 400px;
            background: var(--glass);
            backdrop-filter: blur(25px);
            padding: 1rem;
            border-radius: 1.5rem;
            border: 1px solid rgba(128, 128, 128, 0.3);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            transition: all 0.4s ease;
            color: var(--neon-primary);
        }

        .stealth-active #controls, 
        .stealth-active .utility-bar,
        .stealth-active #settings-trigger {
            opacity: 0;
            transform: translateY(20px) translateX(-50%);
            pointer-events: none;
        }
        
        .stealth-active .utility-bar { transform: translateY(-20px); }
        .stealth-active #settings-trigger { transform: translateY(20px); }

        .utility-bar, #settings-trigger {
            position: fixed;
            z-index: 100;
            transition: all 0.4s ease;
        }
        .utility-bar { top: 20px; right: 20px; }
        #settings-trigger { bottom: 20px; right: 20px; z-index: 110; }

        .btn-icon {
            width: 44px;
            height: 44px;
            background: var(--glass);
            border: 1px solid rgba(128, 128, 128, 0.3);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--neon-primary);
            transition: all 0.2s ease;
            outline: none !important;
        }

        #settings-panel {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 280px;
            background: var(--glass);
            backdrop-filter: blur(30px);
            border-radius: 1.2rem;
            border: 1px solid rgba(128, 128, 128, 0.3);
            padding: 1.5rem;
            z-index: 120;
            display: none;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            color: var(--neon-primary);
        }

        #settings-panel.open { display: block; animation: slideUp 0.2s ease-out; }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .setting-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-weight: 700;
            opacity: 0.8;
            margin-bottom: 0.75rem;
            display: block;
            color: var(--neon-primary);
        }

        .range-slider {
            width: 100%;
            height: 6px;
            -webkit-appearance: none;
            background: rgba(128, 128, 128, 0.3);
            border-radius: 10px;
            outline: none;
            margin: 10px 0;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--neon-primary);
            border-radius: 50%;
            cursor: pointer;
        }

        .sound-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 1rem;
        }

        .sound-chip {
            background: rgba(128, 128, 128, 0.1);
            border: 1px solid rgba(128, 128, 128, 0.2);
            padding: 8px;
            border-radius: 8px;
            font-size: 10px;
            text-align: center;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.2s;
            outline: none !important;
        }

        .sound-chip.active {
            background: var(--neon-primary);
            color: var(--space-bg);
            font-weight: bold;
        }

        .color-picker-custom {
            width: 100%;
            height: 40px;
            border: 1px solid rgba(128,128,128,0.3);
            border-radius: 8px;
            background: rgba(128,128,128,0.1);
            cursor: pointer;
            padding: 4px;
            outline: none;
        }

        .setter-column {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(128, 128, 128, 0.1);
            padding: 6px 10px;
            border-radius: 12px;
            border: 1px solid rgba(128, 128, 128, 0.2);
            color: var(--neon-primary);
        }

        .adjust-btn {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(128, 128, 128, 0.15);
            border-radius: 6px;
            font-weight: bold;
            color: var(--neon-primary);
            outline: none !important;
        }

        .launch-btn {
            background: var(--neon-primary);
            color: var(--space-bg);
            font-weight: 900;
            padding: 12px;
            border-radius: 12px;
            width: 100%;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 0.9rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            outline: none !important;
        }

        .launch-btn.alarm-active {
            background: #ff3e3e;
            color: white;
            animation: pulse-red 1s infinite;
        }

        @keyframes pulse-red {
            0%, 100% { box-shadow: 0 0 0px #ff3e3e; }
            50% { box-shadow: 0 0 25px #ff3e3e; }
        }

        .cursor-hidden { cursor: none !important; }
        *:focus { outline: none !important; }
    </style>
</head>
<body>

    <div class="utility-bar">
        <button class="btn-icon" onclick="toggleFullscreen()" id="fsBtn">
            <svg id="expandIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h6v6M9 21H3v-6M21 3l-7 7M3 21l7-7"/></svg>
            <svg id="collapseIcon" style="display:none;" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 14h6v6M20 10h-6V4M14 10l7-7M3 21l7-7"/></svg>
        </button>
    </div>

    <div id="settings-trigger">
        <button class="btn-icon" onclick="toggleSettings()">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
            </svg>
        </button>
    </div>

    <div id="settings-panel">
        <label class="setting-label">Sound Theme</label>
        <div class="sound-grid">
            <div class="sound-chip active" onclick="setSound('beep', this)">Beep</div>
            <div class="sound-chip" onclick="setSound('echo', this)">Echo</div>
            <div class="sound-chip" onclick="setSound('radar', this)">Radar</div>
            <div class="sound-chip" onclick="setSound('none', this)">None</div>
        </div>
        <div class="mb-4">
            <label class="setting-label">Glow Intensity</label>
            <input type="range" id="glowSlider" class="range-slider" min="0" max="60" value="20">
        </div>
        <div class="mb-4">
            <label class="setting-label">Background Color</label>
            <input type="color" id="bgColorPicker" class="color-picker-custom" value="#020205">
        </div>
        <button onclick="toggleSettings()" class="w-full text-[10px] font-bold uppercase opacity-60 mt-1 tracking-widest outline-none">Done</button>
    </div>

    <div id="canvas-container">
        <canvas id="space-canvas"></canvas>
    </div>

    <div id="display" class="timer-display">
        <div class="unit-group" id="h">00</div>
        <div class="colon-box">
            <div class="colon-dot"></div>
            <div class="colon-dot"></div>
        </div>
        <div class="unit-group" id="m">05</div>
        <div class="colon-box">
            <div class="colon-dot"></div>
            <div class="colon-dot"></div>
        </div>
        <div class="unit-group" id="s">00</div>
    </div>

    <div id="controls">
        <div id="setter-grid" class="grid grid-cols-3 gap-2 mb-3">
            <div class="setter-column">
                <button class="adjust-btn" onclick="adj('hr', -1)">-</button>
                <div class="val-display" id="hrVal">00</div>
                <button class="adjust-btn" onclick="adj('hr', 1)">+</button>
            </div>
            <div class="setter-column">
                <button class="adjust-btn" onclick="adj('min', -1)">-</button>
                <div class="val-display" id="minVal">05</div>
                <button class="adjust-btn" onclick="adj('min', 1)">+</button>
            </div>
            <div class="setter-column">
                <button class="adjust-btn" onclick="adj('sec', -1)">-</button>
                <div class="val-display" id="secVal">00</div>
                <button class="adjust-btn" onclick="adj('sec', 1)">+</button>
            </div>
        </div>

        <div class="flex gap-2 w-full transition-all">
            <button onclick="handleMainAction()" id="mainBtn" class="launch-btn flex-grow">Start</button>
            <button onclick="resetTimer()" id="resetBtn" class="btn-icon">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8m0-5v5h5"/></svg>
            </button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('space-canvas');
        const ctx = canvas.getContext('2d');
        let width, height, mouseX = -2000, mouseY = -2000;
        let particles = [];
        let audioCtx = null;
        let alarmInterval = null;
        let selectedSound = 'beep';
        
        let bgColor = '#020205';
        let contrastColor = '#ffffff'; 
        let timeState = { hr: 0, min: 5, sec: 0 };

        function initAudio() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if (audioCtx.state === 'suspended') audioCtx.resume();
        }

        function setSound(type, el) {
            selectedSound = type;
            document.querySelectorAll('.sound-chip').forEach(c => c.classList.remove('active'));
            el.classList.add('active');
            initAudio();
            playOnce();
        }

        function playOnce() {
            const now = audioCtx.currentTime;
            if (selectedSound === 'beep') {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'square';
                osc.frequency.setValueAtTime(880, now);
                gain.gain.setValueAtTime(0.05, now);
                gain.gain.exponentialRampToValueAtTime(0.001, now + 0.3);
                osc.connect(gain); gain.connect(audioCtx.destination);
                osc.start(); osc.stop(now + 0.3);
            } else if (selectedSound === 'echo') {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.frequency.setValueAtTime(300, now);
                osc.frequency.exponentialRampToValueAtTime(900, now + 0.5);
                gain.gain.setValueAtTime(0.1, now);
                gain.gain.exponentialRampToValueAtTime(0.001, now + 0.6);
                osc.connect(gain); gain.connect(audioCtx.destination);
                osc.start(); osc.stop(now + 0.6);
            } else if (selectedSound === 'radar') {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'sine';
                osc.frequency.setValueAtTime(1200, now);
                gain.gain.setValueAtTime(0.05, now);
                gain.gain.exponentialRampToValueAtTime(0.001, now + 0.1);
                osc.connect(gain); gain.connect(audioCtx.destination);
                osc.start(); osc.stop(now + 0.1);
            }
        }

        function startRepeatingAlarm() {
            if (selectedSound === 'none') return;
            alarmInterval = setInterval(playOnce, selectedSound === 'radar' ? 600 : 1000);
            
            const mainBtn = document.getElementById('mainBtn');
            const resetBtn = document.getElementById('resetBtn');
            const setterGrid = document.getElementById('setter-grid');

            mainBtn.innerText = 'STOP ALARM';
            mainBtn.classList.add('alarm-active');
            
            resetBtn.style.display = 'none';
            setterGrid.style.opacity = '0.3';
            setterGrid.style.pointerEvents = 'none';
        }

        function stopRepeatingAlarm() {
            if (alarmInterval) clearInterval(alarmInterval);
            alarmInterval = null;
            
            const mainBtn = document.getElementById('mainBtn');
            const resetBtn = document.getElementById('resetBtn');
            const setterGrid = document.getElementById('setter-grid');

            mainBtn.classList.remove('alarm-active');
            mainBtn.innerText = 'Start';
            
            resetBtn.style.display = 'flex';
            setterGrid.style.opacity = '1';
            setterGrid.style.pointerEvents = 'auto';
            
            resetTimer();
        }

        class Particle {
            constructor() { this.init(); }
            init() {
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.vx = (Math.random() - 0.5) * 0.4;
                this.vy = (Math.random() - 0.5) * 0.4;
                this.size = Math.random() * 1.5 + 0.6;
                this.maxLife = 200 + Math.random() * 200;
                this.life = this.maxLife;
            }
            update() {
                this.life--;
                const isStealth = document.body.classList.contains('stealth-active');
                if (!isStealth) {
                    const dx = this.x - mouseX;
                    const dy = this.y - mouseY;
                    const distSq = dx*dx + dy*dy;
                    if (distSq < 40000) { 
                        const dist = Math.sqrt(distSq);
                        const force = (1 - dist/200) * 0.6;
                        this.vx += (dx / dist) * force;
                        this.vy += (dy / dist) * force;
                    }
                }
                this.vx *= 0.985; this.vy *= 0.985;
                this.x += this.vx; this.y += this.vy;
                if (this.life <= 0 || this.x < -20 || this.x > width + 20 || this.y < -20 || this.y > height + 20) {
                    this.init();
                }
            }
            draw() {
                const alpha = (this.life / this.maxLife) * (document.body.classList.contains('stealth-active') ? 0.3 : 0.6);
                ctx.fillStyle = contrastColor;
                ctx.globalAlpha = alpha;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function resize() {
            width = window.innerWidth; height = window.innerHeight;
            canvas.width = width; canvas.height = height;
            particles = Array.from({length: 60}, () => new Particle());
        }

        function updateUI() {
            const h = timeState.hr.toString().padStart(2, '0');
            const m = timeState.min.toString().padStart(2, '0');
            const s = timeState.sec.toString().padStart(2, '0');
            ['hrVal','h'].forEach(id => document.getElementById(id).innerText = h);
            ['minVal','m'].forEach(id => document.getElementById(id).innerText = m);
            ['secVal','s'].forEach(id => document.getElementById(id).innerText = s);
        }

        function adj(unit, amount) {
            if (isRunning || alarmInterval) return;
            timeState[unit] += amount;
            if (timeState[unit] < 0) timeState[unit] = 0;
            if (unit !== 'hr' && timeState[unit] > 59) timeState[unit] = 59;
            updateUI();
        }

        function toggleSettings() { document.getElementById('settings-panel').classList.toggle('open'); }

        function setupControls() {
            document.getElementById('bgColorPicker').addEventListener('input', (e) => {
                bgColor = e.target.value;
                contrastColor = (parseInt(bgColor.replace("#", ""), 16) > 0xffffff/2) ? '#000000' : '#ffffff';
                document.body.style.backgroundColor = bgColor;
                document.documentElement.style.setProperty('--neon-primary', contrastColor);
                document.documentElement.style.setProperty('--space-bg', bgColor);
            });
            document.getElementById('glowSlider').addEventListener('input', (e) => {
                document.documentElement.style.setProperty('--glow-strength', `${e.target.value}px`);
                document.documentElement.style.setProperty('--glow-particle', `${e.target.value/2.5}px`);
            });
            document.addEventListener('fullscreenchange', () => {
                const isFS = !!document.fullscreenElement;
                document.getElementById('expandIcon').style.display = isFS ? 'none' : 'block';
                document.getElementById('collapseIcon').style.display = isFS ? 'block' : 'none';
            });
        }

        function draw() {
            ctx.fillStyle = bgColor; ctx.globalAlpha = 1; ctx.fillRect(0, 0, width, height);
            particles.forEach(p => { p.update(); p.draw(); });
            requestAnimationFrame(draw);
        }

        let timerInt, isRunning = false, targetTime, remaining = null;

        function handleMainAction() {
            if (alarmInterval) { stopRepeatingAlarm(); return; }
            togglePlay();
        }

        function togglePlay() {
            initAudio();
            const btn = document.getElementById('mainBtn');
            if (isRunning) {
                isRunning = false; clearInterval(timerInt);
                remaining = Math.ceil((targetTime - Date.now()) / 1000);
                btn.innerText = 'Resume';
            } else {
                let s = remaining !== null ? remaining : (timeState.hr * 3600 + timeState.min * 60 + timeState.sec);
                if (s <= 0) return;
                targetTime = Date.now() + s * 1000;
                isRunning = true; btn.innerText = 'Pause';
                timerInt = setInterval(() => {
                    const diff = Math.max(0, Math.ceil((targetTime - Date.now()) / 1000));
                    document.getElementById('h').innerText = Math.floor(diff/3600).toString().padStart(2, '0');
                    document.getElementById('m').innerText = Math.floor((diff%3600)/60).toString().padStart(2, '0');
                    document.getElementById('s').innerText = (diff%60).toString().padStart(2, '0');
                    if (diff <= 0) {
                        isRunning = false; clearInterval(timerInt);
                        startRepeatingAlarm();
                    }
                }, 100);
            }
        }

        function resetTimer() {
            isRunning = false; clearInterval(timerInt); remaining = null;
            document.getElementById('mainBtn').innerText = 'Start';
            updateUI();
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) document.documentElement.requestFullscreen();
            else document.exitFullscreen();
        }

        let idleTimer;
        function resetIdle() {
            document.body.classList.remove('stealth-active', 'cursor-hidden');
            clearTimeout(idleTimer);
            if (isRunning) {
                idleTimer = setTimeout(() => {
                    if (!document.getElementById('settings-panel').classList.contains('open')) {
                        document.body.classList.add('stealth-active', 'cursor-hidden');
                    }
                }, 800);
            }
        }

        window.onload = () => {
            resize(); setupControls(); updateUI(); draw();
            window.addEventListener('resize', resize);
            window.addEventListener('mousemove', (e) => { mouseX = e.clientX; mouseY = e.clientY; resetIdle(); });
            ['mousedown', 'keydown', 'touchstart'].forEach(evt => window.addEventListener(evt, () => { initAudio(); resetIdle(); }));
        };
    </script>
</body>
</html>
